This is the readme file of the ILK-Compiler tool.

# Usage

## Prerequisites

A valid `Lua` interpreter (`Lua5.2` -- suggested, `Lua5.3` or `Luajit`),
and the `luarocks` tool are required. Please install them from your package
manager (or from sources). For example:

```
sudo apt-get install lua5.2 luarocks liblua5.2-dev
```

### Lua modules

This software depends on a short number of Lua modules,
which can be easily installed manually or through the `luarocks` tools.

The required rocks are:

  * [`luafilesystem`](<http://keplerproject.github.io/luafilesystem/): for file
    manipulation on your filesystem;  
    ```
    sudo luarocks install luafilesystem
    ```


## Running the tool

First issue this command in your shell:

```
eval `luarocks path`
```

And then you can run the actual compiler:

```
./ilk-compiler -b eigen --indir <dir with input files>  --outdir <output dir>
```

For usage information, you can also type

```
./ilk-compiler --help
```

# Generated code

The output directory will contain the C/C++ code generated by the compiler.
Before trying to build this C code, please follow the steps described in the
next section

## Prerequisites

Make sure that the file `robot-defs.h` (generated previously by the ILK-Generator
(_TODO_ link) ) is copied alongside with the generated source code. Normally,
`robot-defs.h` is copied automatically from the input folder to the output
folder.

You will need the Eigen3 C++ library installed in your system, including
the corresponding `pkg-config` configuration file (which is usually
`/usr/local/share/pkgconfig/eigen3.pc`). This file will be installed if you
follow the standard `make` procedure for Eigen.

You also need the Eigen backend which is shipped within this repository. This
is a minimal collection of support functions referenced by the generated code.
Please build and install it in your system, using the standard CMake procedure:

```
cd backend/eigen
mkdir build
cd build
cmake ..
make
sudo make install
```

## Building
Finally, you can compile the generated code simply with `make`.

